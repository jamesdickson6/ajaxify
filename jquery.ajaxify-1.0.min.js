/* ajaxify.jquery.js */
var Ajaxify={version:"1.0",defaultRequestFormat:"ajax",isInitialized:!1,isHandling:!1,isPushing:!1,debug:!1,logMessage:function(a){this.debug&&alert(a)},init:function(){if(Ajaxify.isInitialized)return!0;try{if(window.history&&window.history.pushState){var a=window.history.state&&window.history.state.href,b=location.href;$(window).bind("popstate",function(c){var d=!a&&location.href==b;a=!0;d||((c=history.state||c.state)?Ajaxify.handle(c):window.location=location.href)});Ajaxify.isPushing=!0}}catch(d){Ajaxify.logMessage("error during ajaxify initialization: "+
d)}Ajaxify.isHandling=!0;Ajaxify.isInitialized=!0},ajaxify:function(a,b){Ajaxify.isInitialized||Ajaxify.init();!b&&"object"==typeof a&&(b=a);return this.on("click.ajaxify",a,function(a){var c=$.extend({},b||{},Ajaxify.extractElementAttributes(this)),e="no"!=c.ajaxify;if(!(1<a.which||a.metaKey||a.ctrlKey||a.shiftKey||a.altKey)&&e)return Ajaxify.isPushing&&(c.push=c.push||"push",c.replace&&(push="replace"),"push"==c.push||"yes"==c.push?history.pushState(c,"",this.href):"replace"==c.push&&history.replaceState(c,
"",this.href)),Ajaxify.handle(c),a.preventDefault(),!1})},extractElementAttributes:function(a){try{"string"==typeof a&&("#"==a[0]&&(a=a.substring(1,a.length)),a=document.getElementById(a));var b={},d=a.attributes;for(a=0;a<d.length;a++)b[d[a].nodeName]=d[a].nodeValue;return b}catch(c){return null}},handle:function(a,b){try{b=eval(b||a.handle||a.handler||Ajaxify.defaultHandler),b(a)}catch(d){Ajaxify.logMessage("Ajaxify.handle() error!"+d)}},defaultHandler:function(a){var b=a.href||a.url,d=a.format||
Ajaxify.defaultRequestFormat,c=a.update||a.divid;try{a.jsbefore&&""!=a.jsbefore&&eval(a.jsbefore)}catch(e){}b&&-1==b.indexOf("javascript:")&&(d&&(b&&-1==b.indexOf("format="))&&(b=-1==b.indexOf("?")?b+("?format="+d):b+("&format="+d)),c&&(d=$(c),$(d).prepend('<div class="ajax-spinner"></div>')),$.ajax({url:b,type:a["request-type"]||a.method||"GET",data:null,success:function(b){if(c){var d=$(c);0==d.length&&Ajaxify.logMessage("Container update element '"+c+"' was not found!");$(d).html(b)}try{a.onsuccess&&
""!=a.onsuccess&&eval(a.onsuccess)(b)}catch(e){}},failure:function(b){try{a.onfailure&&""!=a.onfailure&&eval(a.onfailure)(b)}catch(c){}},complete:function(b){try{a.oncomplete&&""!=a.oncomplete&&eval(a.oncomplete)(b)}catch(c){}try{a.jsafter&&""!=a.jsafter&&eval(a.jsafter)}catch(d){}}}))}};(function(a){a.fn.ajaxify=Ajaxify.ajaxify})(jQuery);window.jQuery=jQuery;window.Ajaxify=Ajaxify;
