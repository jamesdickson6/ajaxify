/* ajaxify.jquery-1.0.js */
var Ajaxify={version:"1.0",defaultRequestFormat:"ajax",isInitialized:false,isPushing:false,debug:false,logMessage:function(a){if(this.debug){if(false&&window.console&&window.console.log){window.console.log(a)}else{alert(a)}}},init:function(){if(Ajaxify.isInitialized){return true}try{if(window.history&&window.history.pushState){var a=(window.history.state&&window.history.state.href);var b=location.href;$(window).bind("popstate",function(e){var f=history.state||e.state;var d=!a&&location.href==b;a=true;Ajaxify.isPopped=true;if(d){return}if(f&&f.href==location.href){return}if(f){Ajaxify.handle(f)}else{window.location=location.href}});Ajaxify.isPushing=true}}catch(c){Ajaxify.logMessage("error during ajaxify initialization: "+c)}Ajaxify.isInitialized=true},ajaxify:function(a,b){if(!Ajaxify.isInitialized){Ajaxify.init()}if(!b&&(typeof a=="object")){b=a}return this.on("click.ajaxify",a,function(d){var c=$.extend({},(b||{}),Ajaxify.extractElementAttributes(this));var e=(c.ajaxify!="no");if(d.which>1||d.metaKey||d.ctrlKey||d.shiftKey||d.altKey){return}if(!e){return}if(Ajaxify.isPushing){c.push=c.push||"push";if(c.replace){push="replace"}if(c.push=="push"||c.push=="yes"){history.pushState(c,"",this.href)}else{if(c.push=="replace"){history.replaceState(c,"",this.href)}}}Ajaxify.handle(c);d.preventDefault();return false})},extractElementAttributes:function(f){try{if(typeof(f)=="string"){if(f[0]=="#"){f=f.substring(1,f.length)}f=document.getElementById(f)}var c={};var a=f.attributes;for(var b=0;b<a.length;b++){c[a[b].nodeName]=a[b].nodeValue}return c}catch(d){return null}},handle:function(state,handler){try{handler=eval(handler||(state.handle||state.handler)||Ajaxify.defaultHandler);handler(state)}catch(e){Ajaxify.logMessage("Ajaxify.handle() error!"+e)}},defaultHandler:function(state){var url=state.href||state.url;var format=state.format||Ajaxify.defaultRequestFormat;var divId=state.update||state.divid;var spinner=(state.spinner!="no");try{if(state.jsbefore&&state.jsbefore!=""){eval(state.jsbefore)}}catch(e){}if(url&&url.indexOf("javascript:")==-1){if(format&&url&&url.indexOf("format=")==-1){if(url.indexOf("?")==-1){url+="?format="+format}else{url+="&format="+format}}if(divId){var elms=$(divId);$(elms).prepend('<div class="ajax-spinner"></div>')}var requestType=state["request-type"]||state.method;$.ajax({url:url,type:(requestType||"GET"),data:null,success:function(data){if(divId){var elms=$(divId);if(elms.length==0){Ajaxify.logMessage("Container update element '"+divId+"' was not found!")}$(elms).html(data)}try{if(state.onsuccess&&state.onsuccess!=""){eval(state.onsuccess)(data)}}catch(e){}},failure:function(data){try{if(state.onfailure&&state.onfailure!=""){eval(state.onfailure)(data)}}catch(e){}},complete:function(data){try{if(state.oncomplete&&state.oncomplete!=""){eval(state.oncomplete)(data)}}catch(e){}try{if(state.jsafter&&state.jsafter!=""){eval(state.jsafter)}}catch(e){}}})}}};(function(a){a.fn.ajaxify=Ajaxify.ajaxify})(jQuery);window.jQuery=jQuery;window.Ajaxify=Ajaxify;